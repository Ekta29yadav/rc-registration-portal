<div class="mt-6 container">
  <div class="mt-4 ">
    <h5 class="fs-18">{{'ISSUE_NEW_CREDENTIALS' | translate}}</h5>
    <div class="d-flex filter-bx py-3">
      <div class="floating-form">
        <div class="floating-label">
          <select class="floating-select" aria-label="Default select example" [(ngModel)]="model.schema"
            (ngModelChange)="onModelChange()">
            <!-- <option></option> -->
            <option [ngValue]="undefined" [disabled]="true">{{'SELECT_CREDENTIAL_TYPE' | translate}}</option>
            <option *ngFor="let schema of schemas" [value]="schema.schema_id">{{schema.schema_name}}</option>
          </select>
          <span class="highlight"></span>
          <label class="select-label">{{'CREDENTIAL_TYPE' | translate}}</label>
        </div>
      </div>
      <div class="pl-2">
        <label class="select-label">&nbsp;</label>
        <button class="filter-btn" (click)="downloadTemplate();raiseInteractEvent('download-csv-btn')">{{'DOWNLOAD_CSV'
          | translate}}&nbsp;&nbsp;
          <i class="fa fa-solid fa-file-download"></i></button>
      </div>
      <div class="pl-2">
        <label class="select-label">&nbsp;</label>
        <input #fileUpload [accept]="'.csv'" type="file" class="file-input" (click)="$event.target.value=null"
          (change)="importDataFromCSV($event)" hidden="true" />
        <button class="filter-btn" (click)="openFileBrowser();raiseInteractEvent('upload-csv-btn')">{{'UPLOAD_CSV' |
          translate }}&nbsp;
          <i class="fa fa-solid fa-file-upload"></i></button>
      </div>
    </div>
  </div>
  <hr>

  <div class="d-flex justify-content-center" *ngIf="!csvObject?.length && !issueSingleRecord">
    <button class="btn btn-primary" (click)="showSingleCredentialForm()">
      <i class="fa fa-regular fa-user-plus"></i>&nbsp;&nbsp;{{'ISSUE_CREDENTIALS_FOR_SINGLE_STUDENT' | translate}}
    </button>
  </div>
  <app-data-table [data]="csvObject" *ngIf="csvObject"
    (issueCredentials)="onIssueCredentials($event)"></app-data-table>

  <div *ngIf="issueSingleRecord" class="dynamic-form">
    <form [formGroup]="singleIssueForm" (ngSubmit)="submitDynamicForm($event)">
      <div class="row">
        <div *ngFor="let field of fields" class="col-6 pt-3">
          <label [for]="field.key">{{field.label}}<span class="text-danger" *ngIf="field.isRequired">*</span></label>
          <input type="text" [formControlName]="field.key" class="form-control" [name]="field.key"
            [placeholder]="field.label" />
          <p class="text-danger pt-2 mb-0" *ngIf="singleIssueForm.controls[field.key].dirty && singleIssueForm.controls[field.key].invalid">{{'PLEASE_ENTER_VALID' | translate : {value1: field.label}   }}</p>
        </div>
      </div>
      <div class="d-flex justify-content-center mt-3">
        <button class="btn btn-primary" type="submit">{{'SUBMIT' | translate}}</button>
      </div>
    </form>

  </div>
</div>

<div class="text-center" *ngIf="strictLoader">
  <div class="center-loading">
    <div class="spinner-border">
    </div>
  </div>
</div>

<ng-template #downloadModal tabindex="-1" role="dialog" aria-labelledby="downloadModal">
  <div class="animate-bottom">
    <div class="modal-body">
      <p class="text-center mb-0 p-2 fs-16">
        <i style="color: green" class="fa far fa-check-circle"></i>
        &nbsp;&nbsp;&nbsp;{{'SUCCESSFULLY_DOWNLOADED' | translate}}!
      </p>
    </div>
  </div>
</ng-template>